{"ast":null,"code":"import Stripe from \"stripe\";\nconst stripe = new Stripe(process.env.SECRET_KEY);\nexport default (async (req, res) => {\n  if (req.method === \"POST\") {\n    try {\n      const {\n        amount\n      } = req.body; // Psst. For production-ready applications we recommend not using the\n      // amount directly from the client without verifying it first. This is to\n      // prevent bad actors from changing the total amount on the client before\n      // it gets sent to the server. A good approach is to send the quantity of\n      // a uniquely identifiable product and calculate the total price server-side.\n      // Then, you would only fulfill orders using the quantity you charged for.\n\n      const paymentIntent = await stripe.paymentIntents.create({\n        amount,\n        currency: \"usd\"\n      });\n      res.status(200).send(paymentIntent.client_secret);\n    } catch (err) {\n      res.status(500).json({\n        statusCode: 500,\n        message: err.message\n      });\n    }\n  } else {\n    res.setHeader(\"Allow\", \"POST\");\n    res.status(405).end(\"Method Not Allowed\");\n  }\n});","map":null,"metadata":{},"sourceType":"module"}